
trains = {

    "701": {"маршрут": "Київ – Харків", "прибуття": (10, 15), "відправлення": (10, 30)},
    "112": {"маршрут": "Львів – Полтава", "прибуття": (9, 40), "відправлення": (9, 55)},
    "350": {"маршрут": "Одеса – Суми", "прибуття": (12, 5), "відправлення": (12, 20)},
    "90": {"маршрут": "Харків – Київ", "прибуття": (14, 0), "відправлення": (14, 10)},
    "45": {"маршрут": "Дніпро – Львів", "прибуття": (8, 30), "відправлення": (8, 50)},
    "801": {"маршрут": "Запоріжжя – Київ", "прибуття": (16, 25), "відправлення": (16, 45)},
    "703": {"маршрут": "Київ – Кривий Ріг", "прибуття": (17, 0), "відправлення": (17, 15)},
    "17": {"маршрут": "Чернігів – Одеса", "прибуття": (19, 50), "відправлення": (20, 5)},
    "55": {"маршрут": "Київ – Ужгород", "прибуття": (6, 10), "відправлення": (6, 25)},
    "14": {"маршрут": "Харків – Львів", "прибуття": (21, 30), "відправлення": (21, 45)}
}


def Print(trains):
    """ Виведення всіх записів словника """
    print("\nВсі поїзди:")
    for key in trains:
        print(f"Поїзд {key}: {trains[key]}")


def add(trains, key, route, arr_h, arr_m, dep_h, dep_m):
    """ Додавання нового запису """
    trains[key] = {
        "маршрут": route,
        "прибуття": (arr_h, arr_m),
        "відправлення": (dep_h, dep_m)
    }
    print("Додано запис.")


def Del(trains, key):
    """ Видалення запису """
    try:
        del trains[key]
        print("Запис видалено.")
    except KeyError:
        print(" Помилка: поїзда з таким номером не існує!")


def print_sort(trains):
    """ Виведення словника у відсортованому вигляді """
    print("\nВідсортований словник:")
    for key in sorted(trains):
        print(f"Поїзд {key}: {trains[key]}")


def trains_on_station(trains, h, m):
    """ Визначає, які поїзди стоять на станції у заданий час """
    print(f"\nПоїзди, що стоять на станції о {h:02d}:{m:02d}:")
    found = False

    for num, data in trains.items():
        ah, am = data["прибуття"]
        dh, dm = data["відправлення"]

        # Переводимо час у хвилини
        arr_min = ah * 60 + am
        dep_min = dh * 60 + dm
        t_min = h * 60 + m

        if arr_min <= t_min <= dep_min:
            print(f" Поїзд {num} ({data['маршрут']})")
            found = True

    if not found:
        print("Немає поїздів, що стоять у цей час.")


while True:
    print("\n" + "-" * 50)
    print("1 – Вивести всі поїзди")
    print("2 – Додати новий поїзд")
    print("3 – Видалити поїзд")
    print("4 – Переглянути поїзди за відсортованими ключами")
    print("5 – Визначити, які поїзди стоять у вказаний час")
    print("0 – Вийти")
    print("-" * 50)

    choice = input("Введіть пункт меню: ")

    if choice == "1":
        Print(trains)

    elif choice == "2":
        try:
            key = input("Номер поїзда: ")
            route = input("Маршрут (наприклад Київ – Харків): ")
            arr_h = int(input("Година прибуття: "))
            arr_m = int(input("Хвилини прибуття: "))
            dep_h = int(input("Година відправлення: "))
            dep_m = int(input("Хвилини відправлення: "))

            add(trains, key, route, arr_h, arr_m, dep_h, dep_m)
        except ValueError:
            print("Помилка: годину та хвилину потрібно вводити числами!")

    elif choice == "3":
        key = input("Введіть номер поїзда для видалення: ")
        Del(trains, key)

    elif choice == "4":
        print_sort(trains)

    elif choice == "5":
        try:
            h = int(input("Введіть годину: "))
            m = int(input("Введіть хвилину: "))

            if not (0 <= h <= 23 and 0 <= m <= 59):
                raise ValueError

            trains_on_station(trains, h, m)
        except ValueError:
            print(" Некоректний час!")

    elif choice == "0":
        print("Вихід з програми...")
        break

    else:
        print(" Неправильний вибір меню!")
